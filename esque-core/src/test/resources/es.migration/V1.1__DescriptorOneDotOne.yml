---
requests:
  # create the index template
  - method: "PUT"
    path: "_template/app-cicerone-service-vendor"
    contentType: application/json; charset=utf-8
    body: >
      {
        "index_patterns": [
          "app-cicerone-service-vendor-*"
        ],
        "settings": {
          "refresh_interval": "1s",
          "number_of_shards": 5,
          "number_of_replicas": 1,
          "analysis": {
            "filter": {
              "english_stop": {
                "type": "stop",
                "stopwords": "_english_"
              },
              "english_stemmer": {
                "type": "stemmer",
                "language": "english"
              },
              "english_possessive_stemmer": {
                "type": "stemmer",
                "language": "possessive_english"
              }
            },
            "analyzer": {
              "english_custom": {
                "tokenizer": "standard",
                "filter": [
                  "english_possessive_stemmer",
                  "lowercase",
                  "asciifolding",
                  "english_stop",
                  "english_stemmer"
                ]
              }
            }
          }
        },
        "mappings": {
          "dynamic": "strict",
          "properties": {
            "id": {
              "type": "keyword",
              "store": true
            },
            "createdDate": {
              "type": "date"
            },
            "lastModifiedDate": {
              "type": "date"
            },
            "name": {
              "type": "text",
              "fields": {
                "analyzed": {
                  "type": "text",
                  "analyzer": "english_custom"
                }
              }
            },
            "category": {
              "type": "keyword",
              "norms": true
            },
            "location": {
              "type": "geo_point"
            }
          }
        }
      }

  # create the index for the first schema version
  - method: "PUT"
    path: "app-cicerone-service-vendor-v1"
    contentType: application/json; charset=utf-8

  # create the alias to point to first schema version index
  - method: "POST"
    path: "_aliases"
    contentType: application/json; charset=utf-8
    body: >
      {
        "actions" : [
          {
            "add" : {
              "index" : "app-cicerone-service-vendor-v1",
              "alias" : "app-cicerone-service-vendor"
            }
          }
        ]
      }